<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>圖片/文字轉 PDF 工具 (可編輯版)</title>
    
    <!-- 引入 React 和 ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 引入 jsPDF 用於產生 PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f3f4f6; }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icons Components ---
        const Icon = ({ children, size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const Icons = {
            FileText: (props) => <Icon {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></Icon>,
            Download: (props) => <Icon {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></Icon>,
            ImageIcon: (props) => <Icon {...props}><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></Icon>,
            Upload: (props) => <Icon {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></Icon>,
            CheckCircle: (props) => <Icon {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></Icon>,
            AlertCircle: (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></Icon>,
            Trash2: (props) => <Icon {...props}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></Icon>,
            List: (props) => <Icon {...props}><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></Icon>,
            ArrowLeft: (props) => <Icon {...props}><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></Icon>,
            ArrowRight: (props) => <Icon {...props}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></Icon>,
        };

        // Font URLs to try in order (TTF format required for jsPDF)
        const FONT_URLS = [
            'https://cdn.jsdelivr.net/gh/justfont/open-huninn-font@master/font/jf-openhuninn-1.1.ttf',
            'https://cdn.jsdelivr.net/npm/open-huninn-font@1.1.0/font/jf-openhuninn-1.1.ttf'
        ];

        function App() {
            // State for options
            // 修改: 預設值為空陣列，即不預選任何項目
            const [selectedOptions, setSelectedOptions] = useState([]); 
            const [customText, setCustomText] = useState('');
            const [drinkText, setDrinkText] = useState("溫度選項: 熱飲/正常冰/少冰/微冰/去冰\n甜度 : 正常糖/少糖/半糖/微糖/無糖");
            const [photoSameText, setPhotoSameText] = useState("#照片同 ");
            const [menuSameText, setMenuSameText] = useState("#菜單同 ");
            
            const [images, setImages] = useState([]);
            const [status, setStatus] = useState({ type: '', msg: '' });
            const [isProcessing, setIsProcessing] = useState(false);
            const [fontBase64, setFontBase64] = useState(null); // Cache the font

            // Helper to get the actual text content based on selection
            const getEffectiveText = () => {
                const parts = [];
                if (selectedOptions.includes('price')) parts.push('菜單價格都加30%');
                if (selectedOptions.includes('fixed')) parts.push('甜度冰塊都固定');
                if (selectedOptions.includes('drink_custom')) parts.push(drinkText);
                if (selectedOptions.includes('photo_same')) parts.push(photoSameText);
                if (selectedOptions.includes('menu_same')) parts.push(menuSameText);
                if (selectedOptions.includes('other')) parts.push(customText);
                
                return parts.join('\n'); 
            };

            const toggleOption = (value) => {
                setSelectedOptions(prev => {
                    if (prev.includes(value)) {
                        return prev.filter(item => item !== value);
                    } else {
                        return [...prev, value];
                    }
                });
            };

            const handleImageChange = (e) => {
                if (e.target.files) {
                    const fileArray = Array.from(e.target.files).map((file) => ({
                        file,
                        url: URL.createObjectURL(file)
                    }));
                    setImages((prev) => [...prev, ...fileArray]);
                }
            };

            const removeImage = (index) => {
                setImages((prev) => prev.filter((_, i) => i !== index));
            };

            // 移動圖片的函式
            const moveImage = (index, direction) => {
                const newImages = [...images];
                if (direction === -1 && index > 0) {
                    // 向前 (交換)
                    [newImages[index], newImages[index - 1]] = [newImages[index - 1], newImages[index]];
                } else if (direction === 1 && index < newImages.length - 1) {
                    // 向後 (交換)
                    [newImages[index], newImages[index + 1]] = [newImages[index + 1], newImages[index]];
                }
                setImages(newImages);
            };

            // Helper function to download font
            const downloadFont = async (url) => {
                const response = await fetch(url, { mode: 'cors' });
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const blob = await response.blob();
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        const result = reader.result;
                        const base64data = result.split(',')[1];
                        resolve(base64data);
                    };
                    reader.onerror = reject;
                    reader.readAsDataURL(blob);
                });
            };

            const loadChineseFont = async (doc) => {
                if (fontBase64) {
                    doc.addFileToVFS('jf-openhuninn.ttf', fontBase64);
                    doc.addFont('jf-openhuninn.ttf', 'jf-openhuninn', 'normal');
                    doc.setFont('jf-openhuninn');
                    return true;
                }

                setStatus({ type: 'info', msg: '正在下載中文字型檔 (約 6MB)，初次使用請稍候...' });
                
                for (const url of FONT_URLS) {
                    try {
                        const base64data = await downloadFont(url);
                        setFontBase64(base64data);
                        doc.addFileToVFS('jf-openhuninn.ttf', base64data);
                        doc.addFont('jf-openhuninn.ttf', 'jf-openhuninn', 'normal');
                        doc.setFont('jf-openhuninn');
                        return true; 
                    } catch (err) {
                        console.warn(`字型下載失敗 (${url}):`, err);
                    }
                }

                setStatus({ type: 'warning', msg: '中文字型下載失敗，將使用預設字型 (中文可能無法顯示)。' });
                return false;
            };

            const handleDownload = async () => {
                const finalText = getEffectiveText();

                if (images.length === 0 && !finalText.trim()) {
                    setStatus({ type: 'error', msg: '請至少選擇一個選項或上傳一張圖片' });
                    return;
                }
                
                setIsProcessing(true);
                
                try {
                    const now = new Date();
                    const timestamp = now.toISOString().replace(/[-:T.]/g, '').slice(0, 14);
                    const randomFileName = `PDF_${timestamp}`;

                    const doc = await generatePDF(images, finalText);
                    doc.save(`${randomFileName}.pdf`);

                    setStatus({ type: 'success', msg: `成功！檔案 "${randomFileName}.pdf" 已開始下載。` });
                } catch (error) {
                    console.error(error);
                    setStatus({ type: 'error', msg: `發生錯誤: ${error.message || '未知錯誤'}` });
                } finally {
                    setIsProcessing(false);
                }
            };

            const generatePDF = async (imageList, bodyText) => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                const fontLoaded = await loadChineseFont(doc);
                
                const pageWidth = doc.internal.pageSize.getWidth();
                const pageHeight = doc.internal.pageSize.getHeight();
                const margin = 10; 
                let cursorY = margin;

                if (bodyText && bodyText.trim()) {
                    const maxContentWidth = pageWidth - (margin * 2);
                    doc.setTextColor(51, 51, 51); 

                    if (!fontLoaded) {
                        doc.setFont("helvetica"); 
                    }

                    const targetFontSize = 20;
                    doc.setFontSize(targetFontSize);
                    
                    const wrappedLines = doc.splitTextToSize(bodyText, maxContentWidth);
                    const lineHeight = targetFontSize * 0.3528 * 1.3; 

                    wrappedLines.forEach(line => {
                        if (cursorY + lineHeight > pageHeight - margin) {
                            doc.addPage();
                            cursorY = margin;
                        }
                        doc.text(line, margin, cursorY + lineHeight * 0.8); 
                        cursorY += lineHeight;
                    });
                }

                for (let i = 0; i < imageList.length; i++) {
                    const imgUrl = imageList[i].url;
                    const img = await loadImage(imgUrl);
                    
                    const imgProps = doc.getImageProperties(img);
                    const imgRatio = imgProps.width / imgProps.height;
                    const availableWidth = pageWidth - (margin * 2);
                    const imgHeightInPdf = availableWidth / imgRatio;
                    
                    let currentImgY = 0;
                    let remainingImgHeight = imgHeightInPdf;

                    while (remainingImgHeight > 0) {
                        const availableHeightOnPage = pageHeight - cursorY - margin;
                        
                        if (availableHeightOnPage < 10 && remainingImgHeight > 10) {
                             doc.addPage();
                             cursorY = margin;
                             continue;
                        }

                        const drawHeight = Math.min(remainingImgHeight, availableHeightOnPage);
                        
                        const sourceW = img.width;
                        const sourceH = img.height;
                        const sourceY = currentImgY * (sourceH / imgHeightInPdf);
                        const sourceSliceH = drawHeight * (sourceH / imgHeightInPdf);
                        
                        const canvas = document.createElement('canvas');
                        canvas.width = sourceW;
                        canvas.height = sourceSliceH;
                        const ctx = canvas.getContext('2d');
                        
                        ctx.drawImage(img, 0, sourceY, sourceW, sourceSliceH, 0, 0, sourceW, sourceSliceH);
                        
                        const slicedImgData = canvas.toDataURL('image/jpeg', 0.95);
                        
                        doc.addImage(slicedImgData, 'JPEG', margin, cursorY, availableWidth, drawHeight);
                        
                        cursorY += drawHeight;
                        currentImgY += drawHeight;
                        remainingImgHeight -= drawHeight;
                        
                        if (remainingImgHeight > 0.1) {
                            doc.addPage();
                            cursorY = margin;
                        } else {
                            cursorY += 5; 
                        }
                    }
                }
                
                return doc;
            };

            const loadImage = (url) => {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    img.onload = () => resolve(img);
                    img.onerror = reject;
                    img.src = url;
                });
            };

            return (
                <div className="min-h-screen p-4 md:p-8 max-w-4xl mx-auto">
                    {/* Header */}
                    <div className="flex justify-between items-center mb-8 bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                        <div className="flex items-center gap-3">
                            <div className="bg-blue-600 p-2 rounded-lg text-white">
                                <Icons.FileText size={24} />
                            </div>
                            <div>
                                <h1 className="text-xl font-bold text-gray-800">圖片/文字轉 PDF 工具</h1>
                                <p className="text-sm text-gray-500">
                                    <span className="bg-green-100 text-green-800 px-2 py-0.5 rounded text-xs mr-2">可編輯</span>
                                    瀏覽器端轉換、直接下載
                                </p>
                            </div>
                        </div>
                        {/* Download Button moved to Header */}
                        <button 
                            onClick={handleDownload}
                            disabled={isProcessing}
                            className={`flex items-center gap-2 px-6 py-2.5 rounded-lg text-white font-bold shadow-md transition transform active:scale-95 ${
                                isProcessing ? 'bg-gray-400 cursor-not-allowed' : 'bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700'
                            }`}
                        >
                            {isProcessing ? <div className="loading-spinner border-white border-t-transparent"></div> : <Icons.Download size={20} />}
                            {isProcessing ? '處理中...' : '產生 PDF'}
                        </button>
                    </div>

                    {/* Main Content */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {/* Left: Inputs */}
                        <div className="space-y-6">
                             {/* 1. Option Selection */}
                             <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                <label className="block text-sm font-medium text-gray-700 mb-4 flex items-center gap-2">
                                    <Icons.List size={18} className="text-orange-500"/> 選擇 PDF 內文 (可多選)
                                </label>
                                
                                <div className="space-y-3">
                                    <label className={`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition ${selectedOptions.includes('price') ? 'bg-blue-50 border-blue-300' : 'hover:bg-gray-50'}`}>
                                        <input 
                                            type="checkbox" 
                                            value="price" 
                                            checked={selectedOptions.includes('price')}
                                            onChange={() => toggleOption('price')}
                                            className="w-5 h-5 text-blue-600 rounded focus:ring-blue-500"
                                        />
                                        <span className="text-gray-800 font-medium">菜單價格都加30%</span>
                                    </label>

                                    <label className={`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition ${selectedOptions.includes('fixed') ? 'bg-blue-50 border-blue-300' : 'hover:bg-gray-50'}`}>
                                        <input 
                                            type="checkbox" 
                                            value="fixed" 
                                            checked={selectedOptions.includes('fixed')}
                                            onChange={() => toggleOption('fixed')}
                                            className="w-5 h-5 text-blue-600 rounded focus:ring-blue-500"
                                        />
                                        <span className="text-gray-800 font-medium">甜度冰塊都固定</span>
                                    </label>

                                    {/* 溫度/甜度選項 */}
                                    <div className={`border rounded-lg transition ${selectedOptions.includes('drink_custom') ? 'bg-blue-50 border-blue-300' : 'hover:bg-gray-50'}`}>
                                        <label className="flex items-center gap-3 p-3 cursor-pointer">
                                            <input 
                                                type="checkbox" 
                                                value="drink_custom" 
                                                checked={selectedOptions.includes('drink_custom')}
                                                onChange={() => toggleOption('drink_custom')}
                                                className="w-5 h-5 text-blue-600 rounded focus:ring-blue-500"
                                            />
                                            <span className="text-gray-800 font-medium">溫度/甜度選項 (可修改)</span>
                                        </label>
                                        
                                        {selectedOptions.includes('drink_custom') && (
                                            <div className="px-3 pb-3 pl-11">
                                                <textarea 
                                                    value={drinkText}
                                                    onChange={(e) => setDrinkText(e.target.value)}
                                                    rows="3"
                                                    className="w-full text-base p-2 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-400 outline-none bg-white"
                                                />
                                            </div>
                                        )}
                                    </div>

                                    {/* #照片同 */}
                                    <div className={`border rounded-lg transition ${selectedOptions.includes('photo_same') ? 'bg-blue-50 border-blue-300' : 'hover:bg-gray-50'}`}>
                                        <label className="flex items-center gap-3 p-3 cursor-pointer">
                                            <input 
                                                type="checkbox" 
                                                value="photo_same" 
                                                checked={selectedOptions.includes('photo_same')}
                                                onChange={() => toggleOption('photo_same')}
                                                className="w-5 h-5 text-blue-600 rounded focus:ring-blue-500"
                                            />
                                            <span className="text-gray-800 font-medium">#照片同</span>
                                        </label>
                                        
                                        {selectedOptions.includes('photo_same') && (
                                            <div className="px-3 pb-3 pl-11">
                                                <input 
                                                    type="text"
                                                    value={photoSameText}
                                                    onChange={(e) => setPhotoSameText(e.target.value)}
                                                    className="w-full text-base p-2 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-400 outline-none bg-white"
                                                />
                                            </div>
                                        )}
                                    </div>

                                    {/* #菜單同 */}
                                    <div className={`border rounded-lg transition ${selectedOptions.includes('menu_same') ? 'bg-blue-50 border-blue-300' : 'hover:bg-gray-50'}`}>
                                        <label className="flex items-center gap-3 p-3 cursor-pointer">
                                            <input 
                                                type="checkbox" 
                                                value="menu_same" 
                                                checked={selectedOptions.includes('menu_same')}
                                                onChange={() => toggleOption('menu_same')}
                                                className="w-5 h-5 text-blue-600 rounded focus:ring-blue-500"
                                            />
                                            <span className="text-gray-800 font-medium">#菜單同</span>
                                        </label>
                                        
                                        {selectedOptions.includes('menu_same') && (
                                            <div className="px-3 pb-3 pl-11">
                                                <input 
                                                    type="text"
                                                    value={menuSameText}
                                                    onChange={(e) => setMenuSameText(e.target.value)}
                                                    className="w-full text-base p-2 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-400 outline-none bg-white"
                                                />
                                            </div>
                                        )}
                                    </div>

                                    {/* 其他 */}
                                    <div className={`border rounded-lg transition ${selectedOptions.includes('other') ? 'bg-blue-50 border-blue-300' : 'hover:bg-gray-50'}`}>
                                        <label className="flex items-center gap-3 p-3 cursor-pointer">
                                            <input 
                                                type="checkbox" 
                                                value="other" 
                                                checked={selectedOptions.includes('other')}
                                                onChange={() => toggleOption('other')}
                                                className="w-5 h-5 text-blue-600 rounded focus:ring-blue-500"
                                            />
                                            <span className="text-gray-800 font-medium">或是其他 (自訂文字)</span>
                                        </label>
                                        
                                        {selectedOptions.includes('other') && (
                                            <div className="px-3 pb-3 pl-11">
                                                <textarea 
                                                    value={customText}
                                                    onChange={(e) => setCustomText(e.target.value)}
                                                    placeholder="請輸入文字..."
                                                    rows="3"
                                                    className="w-full text-base p-2 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-400 outline-none bg-white"
                                                />
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>

                            {/* Status Message */}
                            {status.msg && (
                                <div className={`p-4 rounded-lg flex items-center gap-3 ${
                                    status.type === 'error' ? 'bg-red-50 text-red-700 border border-red-100' :
                                    status.type === 'success' ? 'bg-green-50 text-green-700 border border-green-100' :
                                    status.type === 'info' ? 'bg-blue-50 text-blue-700 border border-blue-100' :
                                    'bg-gray-50 text-gray-700 border border-gray-100'
                                }`}>
                                    {isProcessing ? <div className="loading-spinner border-blue-600 border-t-transparent"></div> : 
                                     status.type === 'success' ? <Icons.CheckCircle size={20}/> : <Icons.AlertCircle size={20}/>}
                                    <span className="text-sm font-medium">{status.msg}</span>
                                </div>
                            )}
                        </div>

                        {/* Right: Image Upload & Preview */}
                        <div className="space-y-6">
                            {/* 2. Image Upload */}
                            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                <label className="block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2">
                                    <Icons.ImageIcon size={18} className="text-green-500"/> (選填) 選擇圖片
                                </label>
                                <div className="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:bg-gray-50 transition relative">
                                    <input 
                                        type="file" 
                                        accept="image/*" 
                                        multiple
                                        onChange={handleImageChange}
                                        className="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                                    />
                                    <div className="flex flex-col items-center gap-2 text-gray-400">
                                        <Icons.Upload size={32} />
                                        <span className="text-sm">點擊或拖曳圖片至此</span>
                                    </div>
                                </div>
                            </div>

                            {/* Preview details */}
                            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100 h-fit">
                                <h2 className="font-bold text-gray-700 mb-4 flex justify-between items-center">
                                    <span>內容預覽</span>
                                    {images.length > 0 && (
                                        <button onClick={() => setImages([])} className="text-xs text-red-500 hover:text-red-700">清除圖片</button>
                                    )}
                                </h2>
                                
                                {images.length === 0 ? (
                                    <div className="h-64 flex flex-col justify-center items-center text-gray-300 bg-gray-50 rounded-lg border border-gray-100 mb-6">
                                        <Icons.ImageIcon size={48} className="mb-2 opacity-50"/>
                                        <p className="text-sm">尚未選擇圖片</p>
                                    </div>
                                ) : (
                                    <div className="grid grid-cols-2 gap-3 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar mb-6">
                                        {images.map((img, idx) => (
                                            <div key={idx} className="relative group rounded-lg overflow-hidden border border-gray-200">
                                                <img src={img.url} alt={`Preview ${idx}`} className="w-full h-32 object-cover" />
                                                
                                                {/* Image Controls Overlay */}
                                                <div className="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition flex flex-col justify-between p-1 opacity-0 group-hover:opacity-100">
                                                    {/* Top Right: Delete */}
                                                    <div className="flex justify-end">
                                                        <button 
                                                            onClick={() => removeImage(idx)}
                                                            className="p-1 bg-red-500/80 text-white rounded-full hover:bg-red-600 transition"
                                                            title="移除"
                                                        >
                                                            <Icons.Trash2 size={16} />
                                                        </button>
                                                    </div>
                                                    
                                                    {/* Bottom: Move Controls */}
                                                    <div className="flex justify-between items-center bg-black/50 rounded-lg p-1 backdrop-blur-sm">
                                                        <button 
                                                            onClick={() => moveImage(idx, -1)}
                                                            disabled={idx === 0}
                                                            className={`p-1 text-white hover:bg-white/20 rounded ${idx === 0 ? 'opacity-30 cursor-not-allowed' : ''}`}
                                                            title="向前移動"
                                                        >
                                                            <Icons.ArrowLeft size={16} />
                                                        </button>
                                                        <span className="text-white text-xs font-mono">{idx + 1}</span>
                                                        <button 
                                                            onClick={() => moveImage(idx, 1)}
                                                            disabled={idx === images.length - 1}
                                                            className={`p-1 text-white hover:bg-white/20 rounded ${idx === images.length - 1 ? 'opacity-30 cursor-not-allowed' : ''}`}
                                                            title="向後移動"
                                                        >
                                                            <Icons.ArrowRight size={16} />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                                
                                <div className="pt-4 border-t border-gray-100">
                                    <h4 className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2">PDF 內容摘要</h4>
                                    <div className="text-sm text-gray-600 space-y-1">
                                        <p className="flex justify-between"><span>PDF 標題:</span> <span className="font-medium text-gray-400">無 (隨機檔名)</span></p>
                                        <div className="flex justify-between items-start">
                                            <span className="whitespace-nowrap mr-2">內文內容:</span> 
                                            <div className="font-medium text-blue-600 text-right text-xs whitespace-pre-wrap">
                                                {getEffectiveText() || '無'}
                                            </div>
                                        </div>
                                        <p className="flex justify-between mt-1"><span>圖片數量:</span> <span>{images.length} 張</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
